{% extends "base.html" %}
{% load static %}

{% block body %}
{% include "../components/navbar.html" %}

<!-- FULLCALENDAR -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/locales-all.global.min.js"></script>

<style>
    /* Contenedor general */
    .calendar-wrapper {
        width: 75%;
        margin: 0 auto;
        padding: 20px;
    }

    /* Ajustes visuales */
    #calendar {
        background: white;
        padding: 15px;
        border-radius: 10px;
        box-shadow: 0px 0px 12px rgba(0,0,0,0.1);
    }

    h2 {
        text-align: center;
        margin-bottom: 15px;
        font-weight: 600;
    }

    #user-select {
        padding: 5px 10px;
        border-radius: 6px;
        border: 1px solid #ccc;
    }

    /* Evitar espacios vacíos */
    .fc-scrollgrid,
    .fc-view-harness {
        height: auto !important;
    }

    /* CABECERA DE LOS DÍAS (LUN, MAR, MIÉ...) */
    .fc-col-header-cell {
        background-color: #000 !important;
        color: #fff !important;
        border: none !important;
    }
    .fc-col-header-cell-cushion {
        color: #fff !important;
        font-weight: bold;
        text-decoration: none !important;
    }

    /* CELDAS DEL CALENDARIO — DÍAS NEGROS */
    .fc-daygrid-day {
        background-color: #ffff !important;
        border: 1px solid #d4d4d4 !important;
    }

    /* TEXTO DE LOS NÚMEROS DEL DÍA EN BLANCO */
    .fc-daygrid-day-number {
        color: #000 !important;
        text-decoration: none !important; /* sin subrayado */
    }

    /* QUITAR SUBRAYADO GENERAL */
    a {
        text-decoration: none !important;
    }

    /* HOVER: resaltado al pasar el mouse */
    .fc-daygrid-day:hover {
        background-color: #f1f1f1 !important;
        cursor: pointer;
    }
</style>

<div class="calendar-wrapper">

    <h2>CALENDARIO DE CITAS</h2>


    <div id="calendar"></div>
</div>

<!-- modal placeholder -->
<div id="modal-placeholder"></div>

<!-- MODAL PARA ACTIVIDADES -->
<div class="modal fade" id="activityModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Crear nueva actividad</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body" id="modal-body-content">
        <!-- Aquí se cargará el formulario por AJAX -->
      </div>

    </div>
  </div>
</div>



<script>
// document.addEventListener('DOMContentLoaded', function() {
//     const calendarEl = document.getElementById('calendar');
//     let currentUser = '';

//     const calendar = new FullCalendar.Calendar(calendarEl, {
//         locale: 'es',  // <<< Calendario en español
//         initialView: 'dayGridMonth',
//         height: 'auto',  // <<< Elimina espacio inferior
//         contentHeight: 'auto',
//         expandRows: true, // <<< Evita espacios raros verticales

//         dayMaxEventRows: true,


//         events: function(fetchInfo, successCallback, failureCallback) {
//             let url = '/productivity/api/events/';
//             if (currentUser) {
//                 url += `?user_id=${currentUser}`;
//             }

//             fetch(url)
//                 .then(response => response.json())
//                 .then(data => successCallback(data))
//                 .catch(error => failureCallback(error));
//         }
//     });

//     calendar.render();

//     const userSelect = document.getElementById('user-select');
//     if (userSelect) {
//         userSelect.addEventListener('change', function(e) {
//             currentUser = e.target.value;
//             calendar.refetchEvents();
//         });
//     }
// });

document.addEventListener('DOMContentLoaded', function() {
    const calendarEl = document.getElementById('calendar');

    const calendar = new FullCalendar.Calendar(calendarEl, {
        locale: 'es',
        initialView: 'dayGridMonth',
        height: 'auto',
        contentHeight: 'auto',
        expandRows: true,
        dayMaxEventRows: true,

        events: function(fetchInfo, successCallback, failureCallback) {
            fetch('/productivity/api/events/')
                .then(response => response.json())
                .then(data => successCallback(data))
                .catch(error => failureCallback(error));
        }
    });

    calendar.render();
});

</script>

{% endblock %}
